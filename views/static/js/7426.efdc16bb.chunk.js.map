{"version":3,"file":"static/js/7426.efdc16bb.chunk.js","mappings":"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","sources":["Routes/Facture/GestionCaisseColis/Getion.Caisse.Colis.js"],"sourcesContent":["\nimport React, { Fragment, useState, useEffect } from 'react';\n\n/* import Facture from '../Facture/Facture' */\n\n//import { PageTitle } from '../../layout-components';\n\nimport { Button, InputGroup, FormControl, Row, Col, Card } from \"react-bootstrap\";\nimport axios from \"axios\"\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport ResponsiveContainer from \"react-responsive-widget\";\nimport { CSVLink } from \"react-csv\";\nimport { Link } from \"react-router-dom\";\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\nimport TicketAdd from '../../Ticket/Ticket.add'\nimport TemplatePrint from '../../Template/TemplatePrint'\nimport TemplatePrints from '../../Template/TemplatePrints'\nimport { confirmAlert } from \"react-confirm-alert\";\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import\nimport filterFactory, { textFilter } from 'react-bootstrap-table2-filter';\n\nvar urlbackend = require('../../../env/env')();\n\n\n\n\nfunction GestionCaisseColis() {\n  const [tableshow, settableshow] = useState([])\n  const [selectedRows, setSelectedRows] = useState([])\n  const [facture, setfacture] = useState([])\n  const [data, setDataToShow] = useState([])\n  const [drivers, setdrivers] = useState([])\n  const [encaissement, setencaissement] = useState([])\n\n  const [driverspaid, setdriverspaid] = useState([])\n  function priceFormatter(column, colIndex, { sortElement, filterElement }) {\n    return (\n      <div style={{ display: 'flex', flexDirection: 'column' }}>\n        {filterElement}\n        {column.text}  <span className=\"fa fa-filter\"></span>\n\n\n      </div>\n    );\n  }\n\n  /* const [selectedRows1,setSelectedRows] = useState([]) */\n\n  useEffect(() => {\n    getdata_listpocup()\n\n  }, [])\n  const getdata_listpocup = () => {\n\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Headers': 'Authorization',\n        \"x-access-token\": localStorage.getItem('token'),\n        'Authorization': 'Bearer ' + localStorage.getItem('token'),\n      },\n    };\n    axios.get(urlbackend + \"/driver\", config).then(response => {\n      setdrivers(response.data.data)\n\n    }).catch((e) => {\n\n      console.log(e)\n    })\n\n\n\n  }\n\n\n  /*  const ImprimeSelectedData =()=>{\n     console.log(selectedRows);\n     const result = tableshow.filter(({id}) => selectedRows.includes(id))\n     console.log(result)\n     setDataToShow(result)\n \n \n   } */\n\n\n  /*  const showDataToImprimer = ()=>{\n     return (\n       <div>\n         <TemplatePrint2 Template={data}  > </TemplatePrint2>\n       </div>\n \n     );\n   }\n \n  */\n  const expandRow = {\n    parentClassName: 'parent-expand-foo',\n    renderer: (row, rowIndex) => (\n      <div>\n\n        <p>    <span style={{ color: \"black\", fontWeight: 'bold', textAlign: \"center\" }}>  {`prix :`}{\" \"} </span> {row.colis.price} (TND) </p>\n\n        <p >\n          <span style={{ color: \"black\", fontWeight: 'bold', textAlign: \"center\" }}>  {`Mode de paiment `}{\"     :\"} </span> {row.colis?.payment_mode} </p>\n\n\n        <p>\n          Description produit: {row.colis.designation}\n        </p>\n\n      </div>\n    ),\n    onlyOneExpanding: true,\n  };\n  const linkFollow = (cell, row, rowIndex, formatExtraData) => {\n    return (\n      <div>\n        <Link to={\"/history/colis/provider/\" + row.colis.id}>\n          <Button\n            variant=\"success\"\n            onClick={() => console.log(\"not yet\")}\n          >\n            {\" \"}\n            <span className=\"fa fa-file\"></span>\n          </Button>\n\n        </Link>\n\n      </div>\n    );\n  };\n  const Annulationcolis = (cell, row, rowIndex, formatExtraData) => {\n    return (\n      <div>\n\n        <Button\n          variant=\"danger\"\n          onClick={() => Annulercolis(row.id)}\n        >\n          {\" \"}\n          <span className=\"fa fa-trash\"></span>\n        </Button>\n\n\n\n      </div>\n    );\n  };\n  const Calculertotal = () => {\n\n    var myTotal = 0;  // Variable to hold your total\n\n    for (var i = 0, len = tableshow.length; i < len; i++) {\n      myTotal += parseFloat(tableshow[i].colis.price);  // Iterate over your first array and then grab the second element add the values up\n    }\n    return myTotal\n\n  }\n  const getlistpickups = (id) => {\n    setdriverspaid(id)\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Headers': 'Authorization',\n        \"x-access-token\": localStorage.getItem('token'),\n        'Authorization': 'Bearer ' + localStorage.getItem('token'),\n      },\n    };\n    axios.get(urlbackend + \"/facture/delivery/driver/not_paid/\" + id, config).then(response => {\n      settableshow(response.data.data)\n\n    }).catch((e) => {\n      console.log(e)\n    })\n\n  }\n  const Annulercolis = (id) => {\n    confirmAlert({\n      title: \"Annuler livraison\",\n      message: \"confirmer la suppression définitive?\",\n      buttons: [\n        {\n          label: \"Oui\",\n          onClick: () => {\n            axios\n              .put(urlbackend + \"/delete/pickup/\" + id)\n              .then((res) => {\n                console.log(res);\n                getdata_listpocup()\n                //window.location.reload(true);\n              }).catch((e) => {\n                console.log(e)\n              })\n          },\n        },\n        {\n          label: \"Non\",\n          onClick: null,\n        },\n      ],\n    });\n    /*  */\n  };\n  const linkFollowtick = (cell, row, rowIndex, formatExtraData) => {\n    return (\n      <div>\n\n        <TicketAdd colis={row.colis} />\n\n      </div>\n    );\n  };\n  const impression = (cell, row, rowIndex, formatExtraData) => {\n    return (\n      <div>\n\n        <TemplatePrint Template={row}  > </TemplatePrint>\n\n      </div>\n    );\n  };\n\n\n  const columns = [\n    {\n      dataField: \"colis.index_colis\",\n      text: \"Num colis\",\n      headerFormatter: priceFormatter,\n\n      filter: textFilter(),\n      sort: true\n\n\n    },\n    {\n      dataField: \"colis.lot\",\n      text: \"lot\",\n      headerFormatter: priceFormatter,\n\n      filter: textFilter(),\n\n\n\n    },\n    {\n      dataField: \"colis.name_complete\",\n      text: \"Nom client\",\n      formatter: (cell, row) => {\n        return (<div>{`${row.colis.name_complete} `}<br></br>{`${row.colis.gouvernorat} `} <br></br> {`${row.colis.city}`} {\"  \"} {`${row.colis.address}`} </div>);\n      },\n      headerFormatter: priceFormatter,\n      filter: textFilter(),\n\n\n    },\n    {\n      dataField: \"colis.phone_number\",\n      text: \"N.Telecphone\",\n      style: { textAlign: \"center\" },\n      headerFormatter: priceFormatter,\n      filter: textFilter(),\n\n\n      // formatter: this.linkFollow,\n\n    },\n    {\n      dataField: \"colis.provider.username\",\n      text: \"Expediteur\",\n      headerFormatter: priceFormatter,\n      filter: textFilter(),\n\n    },\n\n    {\n      dataField: \"colis.price\",\n      text: \"Prix(TND)\",\n      headerFormatter: priceFormatter,\n      filter: textFilter(),\n\n    },\n\n\n  ];\n\n\n  const Encaisseddata = () => {\n\n    console.log(selectedRows)\n    console.log(facture)\n    console.log(tableshow)\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Headers': 'Authorization',\n        \"x-access-token\": localStorage.getItem('token'),\n        'Authorization': 'Bearer ' + localStorage.getItem('token'),\n      },\n    };\n    axios.put(urlbackend + \"/facture/driver/to_paid\", {\n      \"colis\": selectedRows,\n      \"factures\": facture\n    }, config).then(response => {\n      alert(\"colis checked delivred\")\n      getlistpickups(driverspaid)\n      setSelectedRows([])\n\n      setfacture([])\n      setDataToShow([])\n      setencaissement([])\n\n    }).catch((e) => {\n      console.log(e)\n    })\n  }\n\n\n\n  const selecthandel = (row, isSelect, e) => {\n\n    if (isSelect) {\n      setSelectedRows((prevSelected) => [...prevSelected, row.colis.id]);\n      setfacture(((prevSelected) => [...prevSelected, row.id]))\n      setencaissement(((prevSelected) => [...prevSelected, row.colis]))\n    } else {\n      setSelectedRows((prevSelected) => prevSelected.filter((x) => x !== row.colis.id));\n      setfacture((prevSelected) => prevSelected.filter((x) => x !== row.id));\n      setencaissement((prevSelected) => prevSelected.filter((x) => x !== row.colis));\n    }\n  }\n  const CalculSimilation_nombre_colis = () => {\n    return selectedRows.length\n\n\n  }\n  const CalculSimilation_encaissment = () => {\n    var myTotal = 0;  // Variable to hold your total\n\n    for (var i = 0, len = encaissement.length; i < len; i++) {\n      myTotal += parseFloat(encaissement[i].price);  // Iterate over your first array and then grab the second element add the values up\n    }\n    return myTotal\n    // return selected.reduce((a, b)=>a.test+b.test)\n\n  }\n  const handleOnSelectAll = (isSelect, rows) => {\n    console.log(isSelect)\n    console.log(rows)\n    if (isSelect) {\n      setDataToShow(rows.map(e => e.colis.id))\n    } else {\n      setDataToShow([])\n    }\n  }\n\n  const selectRow = {\n    mode: 'checkbox',\n    /* clickToExpand: true, */\n    clickToSelect: true,\n    style: { background: '#c8e6c9' },\n    /*  selected: selectedRows, */\n    onSelect: selecthandel,\n    hideSelectAll: true\n\n  };\n\n\n\n  /**\n * function render: return virtual dom\n * @param props {string } include the list of props if that change\n\n */\n  return (\n    <Fragment>{/*\n                 {selectedRows} */}\n      <Card className=\"card-box mb-4\">\n\n        <Card.Header>\n          <Card.Title as=\"h5\">  Total colis   {CalculSimilation_nombre_colis()}  </Card.Title>\n          <br />\n          <Card.Title as=\"h5\">  Total encaissment {CalculSimilation_encaissment()}   </Card.Title>\n        </Card.Header>\n        <ResponsiveContainer>\n          <div className=\"app-row\">\n            <div className=\"app-col-xs-12 app-col-md-12\">\n              <Row>\n\n                <Col md={12} xl={8}>\n\n                  <InputGroup className=\"mb-3\">\n                    <FormControl\n                      as=\"select\"\n                      id=\"{this.state.driver}\"\n                      onChange={(e) => {\n\n                        getlistpickups(e.target.value)\n                      }\n                      }\n                      custom\n                    >\n                      <option>Choisir un chauffeur</option>\n\n                      {drivers.map((driver, index) => (\n                        <option\n                          className=\" badge badge-info\"\n                          key={driver.id}\n                          value={driver.id}\n                        >\n                          {driver.username}\n                        </option>\n                      ))}\n                    </FormControl>\n                  </InputGroup>\n                </Col>\n                <Col md={12} xl={2}>\n\n                  {selectedRows.length !== 0 && <Button variant=\"secondary\" style={{ \"float\": \"right\" }}\n                    onClick={() => Encaisseddata()}> <span className=\"fa fa-money\"></span> Colis encaissé </Button>}\n                </Col>\n\n              </Row>\n\n              <BootstrapTable\n                striped\n                bordered\n                hover\n                variant=\"dark\"\n                expandRow={expandRow}\n                bootstrap4={true}\n                keyField=\"id\"\n                data={tableshow}\n                columns={columns}\n                selectRow={selectRow}\n                pagination={paginationFactory({\n                  sizePerPage: 25,\n                  sizePerPageList: [5, 10, 15, 20, 25],\n                })}\n                filter={filterFactory()}\n                headerClasses=\"table thead-light mb-0\"\n              ></BootstrapTable>\n\n              <CSVLink data={tableshow}><Button\n                color=\"primary\"\n                variant=\"contained\"\n\n              >\n\n              </Button>\n\n              </CSVLink>\n\n\n            </div>\n          </div>\n        </ResponsiveContainer>\n      </Card>\n\n    </Fragment>\n  );\n}\nexport default GestionCaisseColis;"],"names":["urlbackend","require","useState","tableshow","settableshow","selectedRows","setSelectedRows","facture","setfacture","setDataToShow","drivers","setdrivers","encaissement","setencaissement","driverspaid","setdriverspaid","priceFormatter","column","colIndex","sortElement","filterElement","style","display","flexDirection","text","className","useEffect","getdata_listpocup","config","headers","localStorage","getItem","axios","then","response","data","catch","e","console","log","expandRow","parentClassName","renderer","row","rowIndex","color","fontWeight","textAlign","colis","price","payment_mode","designation","onlyOneExpanding","getlistpickups","id","columns","dataField","headerFormatter","filter","textFilter","sort","formatter","cell","name_complete","gouvernorat","city","address","selectRow","mode","clickToSelect","background","onSelect","isSelect","prevSelected","x","hideSelectAll","Fragment","as","length","myTotal","i","len","parseFloat","CalculSimilation_encaissment","md","xl","onChange","target","value","custom","map","driver","index","username","variant","onClick","alert","Encaisseddata","striped","bordered","hover","bootstrap4","keyField","pagination","paginationFactory","sizePerPage","sizePerPageList","filterFactory","headerClasses","CSVLink"],"sourceRoot":""}